{{ $item := .item }}
{{ $has_attachments := partial "functions/has_attachments" $item }}

<div class="pub-list-item view-citation" style="margin-bottom: 3rem">
  <i class="far fa-file-alt pub-icon" aria-hidden="false"></i>

  {{/* APA Style */}}
  {{ if eq (site.Params.publications.citation_style | default "apa") "apa" }}
  {{ $resource := ($item.Resources.ByType "image").GetMatch "*featured*" }}
  {{ with $resource }}
  {{ $image := .Resize (printf "120x q90 %s") }}
    <img style="float: left; margin-right: 20px;" src="{{ $image.RelPermalink }}" alt="" class="img-responsive">
  {{ end }}
  <span class="article-metadata li-cite-author">
    {{ partial "page_metadata_authors" $item }}
  </span>
  ({{- $item.Date.Format "2006" -}}).
  <a href="{{ $item.RelPermalink }}" class="underline">{{ $item.Title }}</a>.<br>
  {{ if $item.Params.publication_short }}
    <a href="{{ $item.Params.published_url }}" class="underline text-primary-400">{{- $item.Params.published_url -}}&#8599;</a>
  {{ else if $item.Params.publication }}
     <a href="{{ $item.Params.published_url }}" class="underline text-primary-400">{{- $item.Params.published_url -}}&#8599;</a>
  {{ end }}

  {{/* MLA Style */}}
  {{ else }}

  {{ $resource := ($item.Resources.ByType "image").GetMatch "*featured*" }}
  {{ with $resource }}
  {{ $image := .Resize (printf "100x q90 %s") }}
    <img style="float: left; margin-right: 20px;" src="{{ $image.RelPermalink }}" alt="" class="img-responsive">
  {{ end }}
  <span class="article-metadata li-cite-author">
    {{ partial "page_metadata_authors" $item }}.
  </span>
  <a href="{{ $item.RelPermalink }}">{{ $item.Title }}</a>.
  {{ if $item.Params.publication_short }}
    {{- $item.Params.publication_short | markdownify -}},
  {{ else if $item.Params.publication }}
    {{- $item.Params.publication | markdownify -}},
  {{ end }}
  {{- $item.Date.Format "2006" -}}.
  <a href="{{ $item.RelPermalink }}" class="underline">{{ $item.Title }}</a>.<br>
  {{ if $item.Params.publication_short }}
    <a href="{{ $item.Params.published_url }}" class="underline text-primary-400">{{- $item.Params.published_url -}}</a>
  {{ else if $item.Params.publication }}
     <a href="{{ $item.Params.published_url }}" class="underline text-primary-400">{{- $item.Params.published_url -}}&#8599;</a>
  {{ end }}

  {{ if $has_attachments }}
  <div class="flex flex-wrap space-x-3">
    {{ partial "page_links" (dict "page" $item "is_list" 1) }}
  </div>
  {{ end }}

  {{ end }}
</div>
